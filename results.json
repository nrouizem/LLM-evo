[["def build_feature(df):\n    \"\"\"\n    Reasoning: Use established heart-rate-based calorie-expenditure formulas (sex-specific)\n    to create a more predictive feature than Age alone. These formulas estimate kcal/min\n    from age, weight, and heart rate; multiplying by Duration gives estimated total calories.\n    The implementation is fully vectorized (no large intermediate arrays) and clips negatives to 0.\n    \"\"\"\n    # ensure numeric types for safe arithmetic\n    age = df['Age'].astype(float)\n    weight = df['Weight'].astype(float)\n    hr = df['Heart_Rate'].astype(float)\n    duration = df['Duration'].astype(float)\n    sex = df['Sex'].astype(int)\n\n    # per-minute estimates (kcal/min) using common formulas (men vs. women)\n    men_per_min = (-55.0969 + 0.6309 * hr + 0.1988 * weight + 0.2017 * age) / 4.184\n    women_per_min = (-20.4022 + 0.4472 * hr - 0.1263 * weight + 0.074 * age) / 4.184\n\n    # choose formula based on Sex (1=male, 0=female)\n    per_min = men_per_min.where(sex == 1, women_per_min)\n\n    # estimated total calories for the activity\n    est_calories = per_min * duration\n\n    # reasonable post-processing: no negative calorie values\n    return est_calories.clip(lower=0)", 0.01119289838926818], ["def build_feature(df):\n    \"\"\"\n    Reasoning:\n    Use a validated heart-rate based energy-expenditure estimate to produce a single strong predictor\n    for calories. Different published linear formulas exist for men and women; apply them vectorized\n    (no large intermediate arrays) and multiply by Duration to get estimated total calories. Clip\n    negatives to zero for robustness. This leverages Heart_Rate, Weight, Age, Duration and Sex,\n    and is efficient for large datasets (single-pass vectorized arithmetic).\n    \"\"\"\n    # Male and female formulas (vectorized). Assumes Weight in kg, Duration in minutes, Heart_Rate in bpm.\n    male = ((-55.0969 + 0.6309 * df['Heart_Rate'] + 0.1988 * df['Weight'] + 0.2017 * df['Age']) / 4.184) * df['Duration']\n    female = ((-20.4022 + 0.4472 * df['Heart_Rate'] - 0.1263 * df['Weight'] + 0.074 * df['Age']) / 4.184) * df['Duration']\n    # Select formula based on Sex (1 = male, 0 = female). Preserve index.\n    est_cal = male.where(df['Sex'] == 1, other=female)\n    # Replace any non-finite or negative estimates with 0, return as a Series aligned with df\n    est_cal = est_cal.fillna(0)\n    est_cal = est_cal.clip(lower=0.0)\n    return est_cal", 0.010535974141021143]]